<!DOCTYPE html>
<html dir="ltr" lang="en">
<head>
  <meta charset="utf-8">
  <meta content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=5.0" name="viewport">
  <title>Stencil Component Starter</title>
  <link href="/build/stellar-core.css" rel="stylesheet">
  <link href="https://rsms.me/inter/inter.css" rel="stylesheet">
  <script type="module" src="/build/stellar-core.esm.js">
  </script>
  <script nomodule src="/build/stellar-core.js">
  </script>
</head>
<body class="theme-red complement-indigo pa5 tc">
  <stellar-theme dark body system></stellar-theme>
  <stellar-mouse-trail count="10" speed="0.7" threedee><stellar-asset src="./global/vector/heart.svg" style="font-size: 3rem;" /></stellar-mouse-trail>

  <stellar-auto-scroll speed="3" loop start-position="100"></stellar-auto-scroll>

  <stellar-scroll-z-root class="relative z-2">
    <stellar-scroll-z-section>
    </stellar-scroll-z-section>
    <stellar-scroll-z-section>
      <stellar-layout>
        <stellar-card>
          <header>
            <h4>Nice!</h4>
          </header>
          <section>
            <copy-wrap>
              <p>Too cool!!</p>
            </copy-wrap>
          </section>
          <footer>
            <h4>Nice!</h4>
          </footer>
        </stellar-card>
      </stellar-layout>
    </stellar-scroll-z-section>
    <stellar-scroll-z-section>
      <stellar-layout>
        <stellar-card>
          <header>
            <h4>Nice!</h4>
          </header>
          <section>
            <copy-wrap>
              <p>Too cool!!</p>
            </copy-wrap>
          </section>
          <footer>
            <h4>Nice!</h4>
          </footer>
        </stellar-card>
      </stellar-layout>
    </stellar-scroll-z-section>
    <stellar-scroll-z-section>
      <stellar-layout>
        <stellar-card>
          <header>
            <h4>Nice!</h4>
          </header>
          <section>
            <copy-wrap>
              <p>Too cool!!</p>
            </copy-wrap>
          </section>
          <footer>
            <h4>Nice!</h4>
          </footer>
        </stellar-card>
      </stellar-layout>
    </stellar-scroll-z-section>
    <stellar-scroll-z-section>
      <stellar-layout>
        <stellar-card>
          <header>
            <h4>Nice!</h4>
          </header>
          <section>
            <copy-wrap>
              <p>Too cool!!</p>
            </copy-wrap>
          </section>
          <footer>
            <h4>Nice!</h4>
          </footer>
        </stellar-card>
      </stellar-layout>
    </stellar-scroll-z-section>
    <stellar-scroll-z-section>
      <stellar-layout>
        <stellar-card>
          <header>
            <h4>Nice!</h4>
          </header>
          <section>
            <copy-wrap>
              <p>Too cool!!</p>
            </copy-wrap>
          </section>
          <footer>
            <h4>Nice!</h4>
          </footer>
        </stellar-card>
      </stellar-layout>
    </stellar-scroll-z-section>

  </stellar-scroll-z-root>

  <web-audio-visualizer for="numbers" type="wave" color="gray" class="fixed w-100 h-100 top-0 left-0 right-0 bottom-0 z-1" style="mix-blend-mode: multiply;"></web-audio-visualizer>

  <web-audio name="numbers">
    <web-audio-source src="./global/audio/music_loop.mp3" name="numbers-song" effectsvolume="20"></web-audio-source>
    <web-audio-source src="./global/audio/music-vox_loop.mp3" name="numbers-song-vox" effectsvolume="20"></web-audio-source>
  </web-audio>

  <web-audio-sequencer name="sequence" tempo="155" taps="270"></web-audio-sequencer>

  <stellar-button tag="button" class="vacation fs1 fixed bottom-1 right-1 dark-tan" size="large" ghost onclick="play()" style="mix-blend-mode: difference;z-index: 9999;--font-size: 4rem;">Toggle</stellar-button>

  <script>
      let playing = false;

      const play = async () => {
        const body = document.querySelector('body');
        const webAudio = document.querySelector('web-audio');
        const sequencer = document.querySelector('web-audio-sequencer');
        const scroller = document.querySelector('stellar-auto-scroll');
        const instrumental = await webAudio.source('numbers-song');
        const vox = await webAudio.source('numbers-song-vox');

        if (playing) {
          await webAudio.stop();
          await instrumental.stop();
          await vox.stop();
          await sequencer.stop();
          await scroller.stop();

          body.classList.remove('kick')
          body.classList.remove('snare')
          body.classList.remove('offbeat')
          playing = false;
        } else {
          sequencer.custom = async function (a,b,c) {
            if (this.currentTap === 0 && this.iterations % 2 === 0) {
              await instrumental.play();
            } else if (this.currentTap === 0 && this.iterations % 2 === 1) {
              await vox.play();
            }

            if (this.currentTap >= 36 && this.currentTap <= 280) {
              if (this.currentTap % 16 === 0) {
                body.classList.add('kick')
              }

              if (this.currentTap % 8 === 0 && this.currentTap % 16 !== 0) {
                body.classList.add('snare')
              }

              if (this.currentTap % 12 === 0) {
                body.classList.add('offbeat')
              }

              if (this.currentTap % 4 === 3) {
                body.classList.remove('kick')
                body.classList.remove('snare')
                body.classList.remove('offbeat')
              }
            }
          }

          await sequencer.play();
          await scroller.play();
          playing = true;
        }
      }
    </script>


  <style>
    body {
      cursor: none;
    }

    .stellar-mouse-trail-element {
      z-index: 3;
    }

    .stellar-mouse-trail-element + .stellar-mouse-trail-element {
      opacity: 0.1;
      z-index: 1;
      mix-blend-mode: difference;
    }
  </style>
</body>
</html>
